package graphStreamVisualizer;

import java.util.List;

import graphStateAbstraction.Test;

import org.graphstream.graph.Graph;
import org.graphstream.graph.implementations.*;

import burlap.domain.singleagent.graphdefined.GraphDefinedDomain;
import burlap.oomdp.core.Domain;
import burlap.oomdp.core.TransitionProbability;
import burlap.oomdp.core.states.State;
import burlap.oomdp.singleagent.Action;
import burlap.oomdp.singleagent.GroundedAction;

public class GraphStreamVisualizer {
	private GraphDefinedDomain d;
	int numStates;

	public GraphStreamVisualizer(GraphDefinedDomain d, int numStates) {
		this.d = d;
		this.numStates = numStates;
	}

	public void render() {	
		Graph graph = new SingleGraph("Tutorial 1");	
		Domain dom = d.generateDomain();

		for (int stateIndex = 0; stateIndex < numStates; stateIndex++) {
			//Add nodes for each state.
			State currState = GraphDefinedDomain.getState(dom, stateIndex);
			graph.addNode(Integer.toString(stateIndex));
			
			//Add edges for transitions.
			for (Action a : dom.getActions()) {
				GroundedAction ga = a.getAssociatedGroundedAction();
				
				List<TransitionProbability> tProbs = ga.getTransitions(currState);
				for (TransitionProbability tProb : tProbs) {
					State sPrime = tProb.s;
					double prob = tProb.p;
					//TODO ADD PROBABILITY
					
					int otherStateIndex = GraphDefinedDomain.getNodeId(sPrime);
					graph.addEdge(Double.toString(prob), Integer.toString(stateIndex), Integer.toString(otherStateIndex));
				}
			}
			
			
			
		}

		GraphDefinedDomain.get
		for (State d.)
		
		graph.addNode("A");
		graph.addNode("B");
		graph.addNode("C");
		graph.addEdge("AB", "A", "B");
		graph.addEdge("BC", "B", "C");
		graph.addEdge("CA", "C", "A");	
		graph.display();
	}
	
	public static void main(String[] args) {
		int n = 5;
		GraphDefinedDomain dg = Test.getNStateChain(n);
		GraphStreamVisualizer test = new GraphStreamVisualizer(dg);
		test.render();
	}

}
